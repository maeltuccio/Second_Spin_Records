<%= link_to "Back", :back %>

<h1 class="chatroom-title">Vous discutez avec <%= @chatroom.user1.email %> et <%= @chatroom.user2.email %></h1>
<%= turbo_frame_tag "chatroom", class: "w-50" do %>
<%= turbo_stream_from @chatroom %>
<div class="chat-container">
  <!-- Conteneur messages -->
  <div id="messages"
     class="message-container mb-4">
  <% @chatroom.messages.each do |message| %>
    <%= render "messages/message", message: message, user: current_user %>
  <% end %>
</div>


  <!-- Formulaire message -->
  <%= simple_form_for [@chatroom, Message.new],
    html: { class: "d-flex mt-3", data: { controller: "reset-form", action: "turbo:submit-end->reset-form#reset" } } do |f| %>
    <% other_user = current_user == @chatroom.user1 ? @chatroom.user2 : @chatroom.user1 %>
    <div class="d-flex w-100">
      <%= f.input :content,
        label: false,
        placeholder: "Message Ã  #{other_user.email}",
        wrapper_html: { class: "flex-grow-1 me-2" },
        input_html: { class: "form-control message-input" } %>
      <%= f.submit "Envoyer", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
<% end %>
